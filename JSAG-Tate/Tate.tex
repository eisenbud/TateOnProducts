\documentclass[twoside,12pt, leqno]{amsart}
\usepackage{amsmath,amscd,amsthm,amssymb,amsxtra,latexsym,epsfig,epic,graphics}
\usepackage[matrix,arrow,curve]{xy}
\usepackage{graphicx}
\usepackage{diagrams}
%\usepackage{pgfplots}
\usepackage{tikz}  %TikZ
\usepackage{color} 
\usetikzlibrary{arrows,calc} 
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.markings} 
\usetikzlibrary{decorations.pathreplacing} 
\usetikzlibrary{plothandlers}
\usepackage[alphabetic,lite]{amsrefs} % for bibliography


%\usepackage{amsrefs}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\textwidth16cm
%\textheig\codim20cm
%\topmargin-2cm
\oddsidemargin.8cm
\evensidemargin1cm

%%%%%Definitions
\input preamble.tex
\def\e{{\epsilon}}
\def\TU{{\bf U}}
\def\AA{{\mathbb A}}
\def\BB{{\mathbb B}}
\def\bB{{\mathbb B}}
\def\PP{{\mathbb P}}
\def\P{{\mathbb P}}
\def\QQ{{\mathbb Q}}
\def\FF{{\mathbb F}}
\def\facet{{\bf facet}}
\def\image{{\rm image}}
\def\name{{\rm name}}
\def\cE{{\cal E}}
\def\cF{{\cal F}}
\def\cG{{\cal G}}
\def\cH{{\cal H}}
\def\cornerT#1{{T_{\Rsh \kern -1pt #1}}}
\def\cHom{{{\cal H}om}}
\def\fix#1{{\bf ***Fix:} #1 {\bf ***}}
\def\david#1{{\bf *** David:} #1 {\bf ***}}
\DeclareMathOperator{\rH}{{\rm H}}
\def\fC{{\mathfrak C}}
\def\Tr{{\rm Tr}}
\def\bT{{\bf T}}
\def\bU{{\bf U}}
\def\bC{{\mathbb C}}
\def\Gr{{\rm Gr}}
\def\CI{{\mathcal I}}
\def\CH{{\mathcal H}}
%\def\CCH{{\mathcal {CNT}}}
\def\CCH{{\mathcal {HC}}}
\def\rH{{\rm H}}
\def\soc{{\rm soc\,}}
\def\jacobian{{\rm Jac}}
\def\Rbar{{\overline R}}
\def\Ibar{{\overline I}}
\def\mm{{\frak m}}
\def\RR{{\mathcal R}}
\def\Trace{{\rm Tr}}

\def\CU{{\mathcal U}}
\def\CO{{\mathcal O}}
\def\CT{{\mathcal T}}
\def\CHom{{\mathcal Hom}}
\def\Spec{{{\rm Spec}\,}}
\def\cone{{{\rm cone}\,}}

\def\tR{{\tilde R}}
\def\tI{{\tilde I}}
\def\tJ{{\tilde J}}
\def\tK{{\tilde K}}
\def\tH{{\tilde H}}
\def\tF{{\tilde F}}

\newarrow{Iso} -----

\def\Abar{{\overline A}}
\def\Rbar{{\overline R}}
\def\Ibar{{\overline I}}
\def\Jbar{{\overline J}}
\def\Kbar{{\overline K}}
\def\abar{{\overline \alpha}}
\def\bbar{{\overline \beta}}
\def\m{{\frak m}}
\def\Rbar{{\overline R}}

\def\gr{{\rm gr}}
\def\init{{\rm in}}

\makeatletter
\def\blfootnote{\xdef\@thefnmark{}\@footnotetext}
\makeatother

\def\frank#1{{\bf *** Frank:} #1 {\bf ***}}
\def\david#1{{\bf *** David:} #1 {\bf ***}}
\def\daniel#1{{\bf *** Daniel:} #1 {\bf ***}}
\def\lbracket{{[\kern-1.5pt[}}
\def\rbracket{{]\kern-1.5pt]}}

\def\seq#1#2{{#1_{1},\dots,#1_{#2}}}
\def\ff#1{{f_{1},\dots, f_{#1}}}

\makeatletter
\def\Ddots{\mathinner{\mkern1mu\raise\p@
\vbox{\kern7\p@\hbox{.}}\mkern2mu
\raise4\p@\hbox{.}\mkern2mu\raise7\p@\hbox{.}\mkern1mu}}
\makeatother


%%%%%%%%%%%%%%%%%%Silvio's macros for the diagrams
\usepackage{times}
%\newdimen\x \x=12pt

%\usepackage{mat\codimime}
\usepackage{color}

%\usepackage{color}
%\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}

\usepackage[breaklinks,bookmarksopen,bookmarksnumbered,urlcolor=blue]{hyperref}
\hypersetup{colorlinks=true,backref=true,citecolor=blue}

%\pagestyle{MYheadings}
%\date{April 2013-December 2015}
\author[David Eisenbud]{David Eisenbud}
\address{Department of Mathematics, University of California at Berkeley and the Mathematical
Sciences Research Institute, Berkeley, CA 94720, USA}
\email{de@msri.org}

\author{Daniel Erman}
\address{Department of Mathematics, University of Wisconsin,
  Madison, Wisconsin, 53706, USA}
\email{derman@math.wisc.edu}


\author[Frank-Olaf Schreyer]{Frank-Olaf Schreyer}
\address{Fachbereich Mathematik, Universit\"at des Saarlandes, Campus E2 4, D-66123 Saar\-br\"ucken, Germany}
\email{schreyer@math.uni-sb.de}



\title[Tate Resolutions on Products of Projective Spaces]{Tate Resolutions on Products of Projective Spaces: \\ Cohomology and Direct Image Complexes}
\begin{document}

\begin{abstract}
We describe the  Macaulay2 package TateOnProducts and its capabilities, which include computing cohomology tables of sheaves
on products of projective spaces and the derived category pushForward of a sheaf under a morphism from a projective scheme to a projective space.
\end{abstract}

\maketitle

%\section*{Introduction} 
\blfootnote{
\noindent AMS Subject Classification:
Primary: 14F05 ,
Secondary: 13D02, 14Q99 \smallbreak
Keywords: cohomology groups, Tate resolutions, Beilinson monads \smallbreak
The first author is grateful to the
National Science Foundation for partial support. This work is a contribution to Project I.6 of the third author within the SFB-TRR 195 "Symbolic Tools in Mathematics and their Application" of the German Research Foundation (DFG).}


\section*{Introduction}
The main functions implemented in this package are:
\begin{enumerate}
	\item  {\tt cohomologyHashTable}, which computes all of the cohomology groups of a coherent sheaf on a product
	of projective spaces, within a specified range of multidegrees;
	\item  {\tt beilinsonMonad}, which computes the Beilinson monad of a sheaf on a product of projective spaces; and
	\item {\tt directImageComplex}, which computes the derived push forward of a coherent sheaf with respect to any of the natural projection maps from a product of projective spaces.
\end{enumerate}
%First, the code cohomologyTable computes all of the graded cohomology groups of a coherent sheaf within a specified range of multidegrees.  Second, the code beilinsonMonad computes the Beilinson monad of a sheaf on a product of projective spaces (see for background on this construction).  Third, the code pushForward computes the derived push forward of a coherent sheaf with respect to any of the natural projection maps from a product of projective spaces.

The algorithms employed exploit the Koszul duality between polynomial rings and exterior algebras, thus turning questions of cohomology of sheaves into questions about free resolutions of modules over an exterior algebra.  The core algorithm of the package is the computation of a finite part of the {\bf Tate resolution} of a coherent sheaf, which is a doubly infinite, multigraded, free complex of free modules over an exterior algebra whose.  The functions mentioned above are easy to compute once this is done.

Tate resolutions were introduced for sheaves on $\PP^n$ in \cite{EFS}.  The Macaulay2 package {\tt BGG} implements an algorithm for computing Tate resolutions for such sheaves, and for using them to compute sheaf cohomology and Beilinson monads~\cite{M2BGG}.  Tate resolutions for products of projective spaces are introduced in \cite{EES}.  
For a product of two or more projective spaces, there is a major new difficulty, as each term of the Tate resolution is a free module of infinite rank.  
%For sheaves on such a product there is a major new difficulty: for a product of two or more projective spaces, each term of the Tate resolution is a free module of infinite rank.  
In this package we compute a part of this infinite object that we call a {\bf corner complex}.  Corner complexes play an essential role in \cite{EES}, and they are sufficient for our applications.

This paper is organized as follows.  In Section~\ref{sec:background}, we briefly review the BGG correspondence and Tate resolution.  In Section~\ref{sec:tate resolutions}, we describe the finite part of a Tate resolution that we can actually compute.  In Section~\ref{sec:cohom tables}, we discuss the command {\tt cohomologyTable}.  
In Section~\ref{sec:beilinson monad}, we provide a brief discussion of Beilinson monads, and discuss the command {\tt beilinsonMonad}.  In Section~\ref{sec:push forward}, we discuss derived push forward algorithms. In the final Section~\ref{sec:cornercomplex}, we introduce the corner complexes, which play a mayor role in the construction of the Tate resolutions and in many of our applications.

\section{The BGG correspondence and Tate resolutions}\label{sec:background}

%This package exploits the Koszul duality between polynomial rings and exterior algebras to turn questions of cohomology of sheaves on a product of projective space into questions about free resolutions of modules over an exterior algebra. This was done for the case of a sheaf on $\PP^n$ in
%\cite{EFS}. The case of products of projective spaces is treated in \cite{EES}. For a product of two or more projective
%spaces there is major technical difficulty, in that the term in the free resolutions that the theory
%associates to sheaves are generally all infinite-dimensional. In this package we compute only a sufficient
%part of this infinite object.

\subsection{Review of Tate Resolutions for Projective spaces}
Fix a field $k$ and an $(n+1)$-dimensional vector space $W$.  We let $S=\Sym W$ be the symmetric algebra, with generators in degree $1$.  We also set $V=W^*$ and let $E=\Lambda V$ be the exterior algebra on $E$, with generators in degree\footnote{Our conventions in this paper are consistent with the conventions in the Macaulay2 packages {\tt BGG} and {\tt TateOnProducts}.  See Remark~\ref{rmk:conventions} for a detailed comparison of how these conventions differ from those in \cite{EFS,EES}.}  $1$.   The BGG correspondence stems from two simple observations.


First, if $A, B, C$ are finite-dimensional vector spaces over $k$, then there is a natural bijection between  homomorphisms $A\otimes_kB\to C$ and homomorphisms
$ B \to C\otimes_k A^*$.

Second, if $M = \oplus_{i\geq i_0} M_i$ is a finitely generated graded $S$-module, then the module structure induces a sequence of map $W\otimes M_i \to M_{i+1}$.  By the correspondence above, this yields a sequence of maps $M_i\to M_{i+1}\otimes V$, which induces a sequence of
linear maps of graded free $E$-modules 
$$ 
bgg(M): \cdots \to M_i\otimes E(i) \to M_{i+1}\otimes E(i+1) \to \cdots
$$
%\daniel{If we are using $E$ instead of $\omega_E$ then let's at least be consistent.  Also why no grading here?}
%Applying the first observation, this  naturally
%\begin{enumerate}
% \item If $A, B, C$ are finite-dimensional vector spaces over $k$, then there is a natural bijection between  homomorphisms $A\otimes_kB\to C$ and homomorphisms
%$ B \to C\otimes A^*$.
%\item %Consider the polynomial ring $S = \oplus_k \Sym_kW$ with generators in degree $1$ and the exterior algebra $E = \Lambda V= \oplus_k \Lambda^kV$, with $V=W^*$ and generators in degree -1.
%If $M = \oplus_{i\geq i_0} M_i$ is a finitely generated graded module over $S$, then the sequence of maps 
%$$
%W\otimes M_i \to M_{i+1}
%$$
% defining the module structure give rise, by the correspondence above,
%to a sequence of maps $M_i\to M_{i+1}\otimes V$, which in turn correspond to a sequence of
%linear maps of graded free $E$-modules 
%$$ 
%bgg(M): \cdots \to M_i\otimes \omega_E \to M_{i+1}\otimes \omega_E \to \cdots
%$$
%where $\omega_E:=\Lambda W=\Hom(E,K)$ is the free $E$-module generated in degree $n+1$, and as $M_j$ a $K$-vectorspace in degree $j$
%\end{itemize}
A formal computation confirms that the conditions of commutativity and associativity of the action of $S$ on $M$ exactly correspond to the condition that $bgg(M)$ is a complex; that is, consecutive maps compose to 0.

In exactly the same way, a graded $E$-module $N$ gives rise to a linear  complex of free $S$-modules
$$bgg(N): \ldots \to N_i \otimes S(i) \to N_{i+1} \otimes  S(i+1) \to \ldots $$

Tate resolutions, as defined below, are exact complexes, and our computation depends on the fact that such a complex is
determined by any differential. However, in general, only a truncation of the complex $bgg(M)$ is exact. This corresponds to a truncation of $M$ at a degree sufficiently high to have a linear resolution over $S$. The following useful criterion shows that such a truncation is necessary, and sufficient:

\begin{theorem}[Reciprocity] \cite[Theorem 3.7 and Corollary 2.4] {EFS}\label{Reciprocity}. With notation as above:
\begin{enumerate}
 \item $bgg(M)$ is an injective resolution of the $E$-module $N$ if and only if
$bgg(N)$ is a free resolution of $M$.

\item These conditions are satisfied if and only if the Castelnuovo-Mumford regularity of $M$ is 0 and $M$ has no submodule of finite length.
\end{enumerate}
\end{theorem}


In their 1978 paper, Bernstein-Gelfand-Gelfand \cite{BGG} used the BGG correspondence to identify  the derived category $D^b(\PP^n)$ of bounded complexes of coherent sheaves on $\PP^n$ with the stable category of $E$-modules. In the same volume \cite{beilinson} Beilinson described
$D^b(\PP^n)$ in terms of exceptional sequences.  (See Section~\ref{sec:beilinson monad} for more on Beilinson's work.)

%Namely, let 
%$\CU$ denote the universal rank $n$ subbundle on $\PP^n=\PP(W)$:
%$$ 0 \to U \to W\otimes \sO \to \sO(1) \to 0.$$ 
%\daniel{$U$ looked like a vector space here, so I changed it to $\CU$.}
%Beilinson shows that both $\{ \sO(-k) | k=1,\ldots,n\}$ and 
%$\{ \Lambda^k \CU | k=0, \ldots, n\}$ form what is nowadays called  a semi-orthogonal full exceptional exceptional sequences for $D^b(\PP^n)$.
%A key point is, that the diagonal $\Delta \subset \PP^n \times \PP^n$ has a Koszul resolution
%$$ 
%0 \to \Lambda^n \CU \boxtimes \sO(-n) \to \ldots \to \CU \boxtimes \sO(-1) \to \sO \to \sO_\Delta \to 0
%$$
%where $A \boxtimes B = pr_1^* A \otimes pr_2^* B$ for  coherent sheaf $A,B$ on $\PP^n$ denotes their tensor product on $\PP^n \times \PP^n$ after pull back along the first and second projection.

Tate resolutions, as introduced in~\cite{EFS}, connect the approaches of \cite{BGG} and \cite{beilinson} and provide the foundation for the package~\cite{M2BGG}.
Let $M=\oplus M_d$ be a graded $S$-module representing the coherent sheaf $\sF$ on $\PP^n$. For any $r$, the truncation $M_{\ge r} = \oplus_{d \ge r}M_d$ represents the same sheaf.  If $r\gg 0$, then Theorem~\ref{Reciprocity} shows that the  complex
$$
bgg(M_{\ge r}) : M_r\otimes E(r) \to M_{r+1}\otimes E(r+1) \to \ldots
$$ 
is acyclic. By combining this injective resolution with a minimal free resolution of $P=\ker(M_r\otimes E(r) \to M_{r+1}\otimes E(r+1))$, we obtain an infinite exact complex
$$
\bT(\sF):   \ldots \to T^{r-2} \to T^{r-1} \to T^r \to T^{r+1} \to \ldots
$$
of free $E$-modules, which depends only on $\sF$.  This is called the {\bf Tate resolution of $\sF$}. Any finite part can be found by computing syzygies over the exterior algebra.

By \cite[Theorem 4.1] {EFS}, the Betti numbers of $\bT(\sF)$ encode the ranks of the sheaf cohomology groups of $\sF$ via the following formula:
$$
\bT^d(\sF) =T^d= \sum_{i=0}^n H^i(\PP^n,\sF(d-i)) \otimes E(d-i).
$$
and thus the syzygy computation yields the dimensions of the vector spaces $H^i(\PP^n,\sF(d))$ in any bounded range. The Beilinson monad of $\sF$ can also be obtained from the Tate resolution---see Section~\ref{sec:beilinson monad}.

% 
% $$\diagram
% \bU: &\{ \hbox{free $\omega_E$-modules}\} & \rTo & \{ \hbox{coherent sheaves on $\PP^n$} \}   \cr
%  &\omega_E(i) & \mapsto & \Lambda^i U \subset \Lambda^i W \otimes \sO \cr
%&\dTo^{a\cdot}&&   \dTo_{\neg a} \cr
%&\omega_E(j) &\mapsto& \Lambda^j U \subset \Lambda^j W \otimes \sO \cr
%\enddiagram
%$$
% to $\bT(\sF)$ for $a \in \Lambda^{i-j} V \subset E$ a homogeneous element of degree $j-i$. Since this $\Lambda^i U \not=0$ for $0 \le i \le n$, the complex $\bU(\sF)$ depends only on a bounded part of $\bT(\sF)$.
% One of Beilinson's main theorems says that the complex $\bU(\sF)$ is exact except at position $0$:
% $$ \rH^* \bU(\sF) = \rH^0 \bU(\sF) \cong \sF.$$
% 
% \medskip

\subsection{Tate Resolutions for Products of Projective Spaces}
We now consider a product of projective spaces $\PP = \PP^{n_1}\times \ldots \times \PP^{n_{t}}$.  The Cox ring of $\PP$ is a $\ZZ^{t}$-graded polynomial ring $S=\Sym (W_1\oplus W_2 \oplus \cdots \oplus W_t)$ where $\dim W_i=n_i+1$ and where the elements of $W_1$ have degree $(1,0,\dots,0)$, the elements of $W_2$ have degree $(0,1,0,\dots,0)$ and so on.  As before, we let $V_i=W_i^*$ for all $i$, and define a $\ZZ^{t}$-graded exterior algebra $E=\Lambda (V_1\oplus V_2\oplus \cdots \oplus V_t)$ where $\deg(W_i)=\deg(V_i)$.  When comparing multidegrees in $\ZZ^t$, we always take the termwise partial order.  

By a nearly identical computation as before, the BGG correspondence $M\mapsto bgg(M)$ sends a multigraded $S$-module to a linear, mulitgraded, free, $t$-fold multil-complex of $E$-modules.  For instance, if $t=2$, then $bgg(M_{\ge(i,j)})$ is the total complex of a double complex:
\begin{equation}\label{eqn:uppercorner}
\xymatrix{ \vdots & \vdots & \\
 M_{i,j+1}\otimes E(i,j+1) \ar[r]\ar[u]& M_{i+1,j+1}\otimes E(i+1,j+1)\ar[u] \ar[r] & \cdots \\
 M_{i,j}\otimes E(i,j) \ar[r]\ar[u]& M_{i+1,j}\otimes E(i+1,j) \ar[u]  \ar[r] & \cdots \\
}
\end{equation}
In general, $bgg(M)$ is the total complex of a $t$-fold complex.


\begin{remark}\label{rmk:conventions}
We follow the conventions of the package \cite{TateOnProducts}, which differs from the conventions of \cite{EES}. In particular, in the paper:
\begin{itemize}
\item The exterior algebra $E$ is negatively graded.
\item We use $\omega_E$ instead of $E.$
\item Tate resolutions are cochain complexes instead of chain complexes.
\end{itemize}
\end{remark}
%We consider again a pair of Koszul dual symmetric and exterior algebras:
%If $\PP^{n_i}= \PP(W_i)$ then we consider the $\ZZ^t$-graded polynomial ring 
%$$
%S=\Sym(W_1 \oplus \ldots \oplus W_t)
%$$
%and the $\ZZ^t$-graded algebra $E= \Lambda(V_1 \oplus \ldots \oplus V_t)$ where $V_i =W_i^*$.

The theory of Tate resolutions for 
$
\PP$ is developed in~\cite{EES}.  If $M$ is a graded $S$-module representing $\sF$, then the Tate resolution $\bT(\sF)$ is an
exact complex of free $E$-modules with terms
\begin{equation}\label{eqn:Tate products}
\bT^d(\sF)= \sum_{a \in \ZZ^t} H^{d-|a|}(\PP,\sF(a)) \otimes E(a),
\end{equation}
where $|a|=a_1+\ldots+a_n$ denotes the total degree.
This shows that the Tate resolution encodes all the cohomology groups
$ H^j(\PP, \sF(a))$.
However, \eqref{eqn:Tate products} also shows that, when $t>1$, each term $\bT^d(\sF)$ of the Tate resolution will be an infinitely generated $E$-module. Computing the entire Tate resolution $\bT^d(\sF)$ is thus infeasible.  We can nevertheless  effectively compute the subquotient complex of $\bT^d(\sF)$ which consists of all terms in a finite range
$
low \le a \le high
$
of multidegrees with $low, \, high \in \ZZ^t $ and this is sufficient for all of our applications.


%Challenge of toric varieties.


\section{Tate Resolutions}\label{sec:tate resolutions}
Each of the major applications in this package stems from the computation of a bounded part of the Tate resolution.
Let $M$ be a finitely generated $\ZZ^t$-graded $S$-module, and let $\sF$ be the 
corresponding sheaf on $\PP$. Let
$low\leq high\in \ZZ^t$ be multi-degrees defining an interval.  The function
\begin{verbatim}
tateResolution(M,low,high)
\end{verbatim}
computes a subquotient complex of $\bT(\sF)$ that contains all summands generated in degrees $low\leq a \leq  high$.  To compute this, Macaulay2 first finds some $b\gg 0$ such that the total complex of $bgg(M_{\geq b})$ is acyclic.  	Then, we resolve the kernel of  the first map in this complex, continuing until we have covered all of the degrees in the desired range.  This yields a multigraded complex $T$ of finitely generated, free $E$-modules.  In the specified degrees, the subquotient complexes of $T$ and $\bT(\sF$) coincide.  This coincidence is essential to the computability of $\bT(\sF)$ within the desired range, and it relies on the somewhat subtle theory of corner complexes, briefly described in Section \ref{sec:cornercomplex} and treated in detail in~\cite{EES}.

For example, let $\PP=\PP^1\times \PP^2$ and let $M=S^1$ be a module representing $\sF=\cO_{\PP^1\times \PP^2}$.  The input
\begin{verbatim}
T = tateResolution(M,{-3,-3},{0,0})
\end{verbatim}
computes a multi-graded complex of the form
{\small \begin{verbatim}

      21      6      1      2      6      14      29
     E   <-- E  <-- E  <-- E  <-- E  <-- E   <-- E
                                                      
     -2      -1     0      1      2      3       4
\end{verbatim}}
\noindent which includes all the free summands in the Tate resolution that have generators in degree $(-3,-3)\leq a\leq (0,0)$. Here the numbers below the free modules are the homological degrees. (The map between the terms in homological degree $-2$ and $-1$ is actually not part of the Tate resolution but  comes from the construction of $T$ as a corner complex. We will return to corner complexes in Section \ref{sec:cornercomplex}). 

The Betti table of this complex with respect to total degree, is
\goodbreak
{\small \begin{verbatim}
betti T
            -2 -1 0 1 2  3  4
     total: 21  6 1 2 6 14 29
        -1: 21  6 . . .  .  .
         0:  .  . 1 . .  .  .
         1:  .  . . 1 2  3  4
         2:  .  . . 1 3  6 10
         3:  .  . . . 1  5 15
\end{verbatim}}
\noindent

\section{Computing Cohomology Tables}\label{sec:cohom tables}
To compactly represent the dimensions of all of the cohomology vector spaces of a given coherent sheaf $\sF$ we introduce the ``cohomology polynomial''
$$
\sum_{i\geq 0} (\dim H^i(\PP, \sF))h^i\in \ZZ[h].
$$
To shorten the notation, we usually write $H^i(\sF)$ in place of $H^i(\PP, \sF)$.
Let $M$ be a finitely generated $\ZZ^t$-graded $S$-module, and let $\sF$ be the 
corresponding sheaf on $\PP$. Let
$low\leq high\in \ZZ^t$ be multi-degrees defining an interval. We can compute
all the cohomology vector spaces of all the twists $\sF(a)$ for $low\leq a\leq high$ with the function 
{\small \begin{verbatim}
eulerPolynomialTable(M,low,high)
\end{verbatim}}
The output of this function is a hash table consisting of the pairs
$$ 
a \Rightarrow \sum_{i\geq 0} (\dim H^i(\PP, \sF(a))h^i.
$$
As in the case of a single projective space, these are computed as Betti numbers of the appropriate finite  part of the Tate resolution.

For example,  if $\PP=\PP^1\times \PP^2$ and   $\sF = \sO_{\PP^1\times \PP^2}$, represented by the module
$S^1$, then:
{\small \begin{verbatim}
 (S,E) = productOfProjectiveSpaces{1,2}
 low  = {-3,-3};high = {3,3};
 eT = eulerPolynomialTable(S^1, low,high);
 eT#{2,-3}
\end{verbatim}}
gives output
\begin{verb}
3h2 
\end{verb}
This means that $H^2(\sF(2,-3))$ has rank $3$ and that $H^i(\sF(2,-3)) = 0$ for $i\ne 2$.

In the case $t=2$, we can display the hash table as a matrix using the function
\begin{verb}
 cohomologyMatrix(M,low,high)
\end{verb},
where the upper right hand corner of the table corresponds to the multi-index $high$: Continuing with the previous example,
we have:
% represent $\sF = \sO_{\PP^1\times \PP^2}$ with the module
%$S^1$:
{\small \begin{verbatim}
cohomologyMatrix(S^1, low,high)
\end{verbatim}}
\noindent gives output
{\small 
\begin{verbatim}
     | 20h 10h 0 10 20  30  40  |
     | 12h 6h  0 6  12  18  24  |
     | 6h  3h  0 3  6   9   12  |
     | 2h  h   0 1  2   3   4   |
     | 0   0   0 0  0   0   0   |
     | 0   0   0 0  0   0   0   |
     | 2h3 h3  0 h2 2h2 3h2 4h2 |
\end{verbatim}}
Because $high = \{3,3\}$ the index of the top row is 3 as is the index of the right-hand column. A polynomial $\sum_m d_mh^m$ in the $i$-th row and $j$-th column indicates that the dimension
of $H^m(\sF(i,j))$ is $d_m$. 

Among the things to note about this matrix are that the $-1$ column and both the $-2$ and $-3$ rows consist of  zeros. This corresponds to the fact that $\sF(i,j)$ has no cohomology whatsoever when $i=-1$ or when $j=-1$ or $-2$.


\section{Short Beilinson Monad}\label{sec:beilinson monad}
Let $\sF$ be a coherent sheaf on $\PP$.  The Beilinson monad of $\sF$ is a complex of sheaves $\sB$ whose terms are direct sums of sheaves from an exceptional collection on $\PP$ built from exterior powers of the cotangent bundles on the factors, and whose homology groups satisfy
$$
H^{i}\sB = \begin{cases} \sF & if\  $i=0$\\
0& otherwise 
\end{cases}.
$$
The advantage of this representation is that the terms of the $\sB$ depend only on the cohomology groups of
$\sF$. See~\cite{beilinson,AO,EFS,Huy} for discussion of Beilinson monads and ~\cite[\S2]{EES} for a discussion in the context of $\PP$.  As explained in~\cite[\S2]{EES}, the Beilnson mood for $\sF$ is determined by the subquotient complex of $\bT(\sF)$ consisting of summands generated in the finite range of degrees $0\leq a \leq n$.  This range of degrees is known as the {\em Beilinson window,} and a Beilinson monad for a $\sF$ can be  computed easily from any finite part of the Tate resolution that contains the Beilinson window.  

For the computation, we start with a module $M$ representing a coherent sheaf $\sF$ on $\PP$. Executing
{\small \begin{verbatim}
B = beilinsonMonad M
\end{verbatim}}
\noindent produces a complex $B$ of graded $S$-modules such that the corresponding complex $\widetilde{B}$ of sheaves on $\PP$ is the Beilinson monad for $\sF$.
    
For example, if we take $M$ to be a twist of the syzygy module of the maximal ideal in the bihomogeneous
coordinate ring $S$ of $\PP=\PP^1\times \PP^2$, we can execute:
{\small \begin{verbatim}
M =  S^{{1,1}} ** ker vars S
%cohomologyMatrix (M,{-3,-3}, {3,3})
\end{verbatim}}
%This outputs:
%{\small \begin{verbatim}
%      | 75h 30h 15  60  105 150  195  |
%      | 48h 20h 8   36  64  92   120  |
%      | 27h 12h 3   18  33  48   63   |
%      | 12h 6h  0   6   12  18   24   |
%      | 3h  2h  h   0   1   2    3    |
%      | 0   0   0   0   0   0    0    |
%      | 3h3 0   3h2 6h2 9h2 12h2 15h2 |
%\end{verbatim}}
     %Since $\bU E(a)$ is nonzero only when $a$ is in the range $-n\leq a \leq 0$, the output of the functor $\bU$ only depends on the piece of $\bT(\sF)$ with generators lying in the Beilinson window.  
The command \verb beilinsonWindow \ computes the subquotient complex of the Tate resolution in the degrees $0\leq a \leq n$.  In our example, this complex only has two terms:
{\small \begin{verbatim}
T=tateResolution(M,low,high);
W = beilinsonWindow T
        6      1
       E  <-- E
betti W
             0 1
      total: 6 1
          0: 6 .
          1: . 1
 \end{verbatim}}
The Beilinson monad itself is obtained by applying a certain $\bU$ functor (see \cite[\S2]{EES}) to any piece of $\bT(\sF)$ which contains the Beilinson window.  This is computed directly from the module $M$ via:
\begin{verbatim}
B = beilinsonMonad M
\end{verbatim}
which, in this case, gives a two-term complex:
{\small
\begin{verbatim}     
 6
S  <-- cokernel {1, 1} | x_(1,2)  |
                {1, 1} | -x_(1,1) |
                {1, 1} | x_(1,0)  |
\end{verbatim}}
Macaulay2 computes this by computing sufficiently many terms of the Tate resolution
of $\sF$, extracting the terms
that belong to the Beilinson window, and then applying the functor $\bU$.

The 0th-cohomology of the Beilinson monad is a module representing the sheaf $\sF$,
while the other cohomology groups are trivial as sheaves---that is, supported on the irrelevant ideal. 
Note also that the 0th-cohomology may not be equal to the module $M$, but the two modules
will agree after  truncating at a sufficiently positive multi-degree.
For instance:
{\small
\begin{verbatim}
isIsomorphic(HH^0 B ,M)
   false
isIsomorphic (truncate({0,0},HH^0 B),truncate({0,0},M))
   true
\end{verbatim}}
\noindent Similarly, the other cohomology of $B$ will have irrelevant support, and therefore will be 0 in sufficiently positive degree. 
\fix{do we need to clarify that ``sufficiently positive degree`` is NOT the same as ``sufficiently high total degree''?}

    


\section{The Beilinson Monad}\label{sec:beilinson monad}
Let $\sF$ be a coherent sheaf on $\PP^n$. 
Let $\CU$ denote the universal rank $n$ subbundle on $\PP^n=\PP(W)$:
$$ 0 \to \CU \to W\otimes \sO \to \sO(1) \to 0.$$ 
In~\cite{beilinson}, Beilinson shows that both $\{ \sO(-k) | k=1,\ldots,n\}$ and 
$\{ \Lambda^k \CU | k=0, \ldots, n\}$ form what is nowadays called a semi-orthogonal full exceptional  sequences for $D^b(\PP^n)$.
%A key point is, that the diagonal $\Delta \subset \PP^n \times \PP^n$ has a Koszul resolution
%$$ 
%0 \to \Lambda^n \CU \boxtimes \sO(-n) \to \ldots \to \CU \boxtimes \sO(-1) \to \sO \to \sO_\Delta \to 0
%$$
%where $A \boxtimes B = pr_1^* A \otimes pr_2^* B$ for  coherent sheaf $A,B$ on $\PP^n$ denotes their tensor product on $\PP^n \times \PP^n$ after pull back along the first and second projection.
The Beilinson monad of $\sF$ provides a way to represent $\sF$ in terms of the second of these exceptional collections $\CU$.  See~\cite{beilinson,AO,EFS,Huy} for discussion of Beilinson monads.

%There is a functor:
% $$\diagram
% \bU: &\{ \hbox{free $E$-modules}\} & \rTo & \{ \hbox{coherent sheaves on $\PP^n$} \}   \cr
%  &\omega_E(i) & \mapsto & \Lambda^i \CU \subset \Lambda^i W \otimes \sO \cr
%&\dTo^{a\cdot}&&   \dTo_{\neg a} \cr
%&\omega_E(j) &\mapsto& \Lambda^j \CU \subset \Lambda^j W \otimes \sO \cr
%\enddiagram
%$$


Beilinson's results carry over to products of projective spaces.  We let $\CU_i$ denote the universal rank $n_i$ subbundle on $\PP^{n_i}$.  For $a\in \ZZ^{t}$ we set
$$
\Lambda^a \CU := \boxtimes_{i=1}^t \Lambda^{a_i} \CU_i=\pi_1^*\Lambda^{a_1}\CU_1 \otimes \cdots \otimes \pi_t^*\Lambda^{a_t} \CU_t,
$$
the tensor product of the pullbacks to $\PP$ of exterior powers of the $\CU_i$. The set $\{\Lambda^a \CU | 0 \leq a \leq n=(n_1,n_2,\dots,n_t)\}$ forms a semi-orthogonal full exceptional exceptional sequences for $D^b(\PP)$, and the Beilinson monad for $\PP$ represents a sheaf $\sF$ in terms of this exceptional collection.  See~\cite[\S2]{EES} for more details.

A Beilinson monad for $\sF$ can be computed from the Tate resolution of $\sF$.  A key observation is that $\Hom(\Lambda^a \CU,\Lambda^b\CU) \cong \Lambda^{a-b} V=E_{a-b}$.  Writing $\neg z$ for the map corresponding to $z\in E$, there is thus a functor
\[
\bU: \{ \hbox{free $E$-modules}\} \longrightarrow \{ \hbox{coherent sheaves on $\PP$} \}  
\] defined by
\[
\xymatrix{
&E(-a)\ar[r]^-{\bU}\ar[d]^-{\cdot z}&\Lambda^a \CU\ar[d]^{\neg z}\\
&E(-b)\ar[r]^-{\bU}&\Lambda^b \CU\\
}
\]
% $$\diagram
% \bU: &\{ \hbox{free $E$-modules}\} & \rTo & \{ \hbox{coherent sheaves on $\PP$} \}   \cr
%  &E(a) & \mapsto & \Lambda^a \CU \cr
%&\dTo^{z\cdot}&&   \dTo_{\neg z} \cr
%&E(b) &\mapsto& \Lambda^b \CU  \cr
%\enddiagram.
%$$
 %to $\bT(\sF)$ for $a \in \Lambda^{i-j} V \subset E$ a homogeneous element of degree $j-i$. 
One of Beilinson's main theorems, transposed to the case of a product of projective spaces, shows that the complex $\bU(\sF)$ is quasi-isomorphic to the original sheaf $\sF$.  Namely: $\bU(\sF)$ only has homology at position $0$, and there we have $ \rH^* \bU(\sF) = \rH^0 \bU(\sF) \cong \sF.$

Since  $\Lambda^a \CU$ is only nonzero for $a$ in the range $0 \le a \le n$, the complex $\bU(\sF)$ in fact depends only on the  part of $\bT(\sF)$ consisting of free $E$-modules generated in degrees $0\le a \le n$.  This range is known as the {\bf Beilinson window}.  We can thus  compute a Beilinson monad for $\sF$ from any piece of the Tate resolution $\bT(\sF)$ which contains the Beilinson window.

For the computation, we start with a module $M$ representing a coherent sheaf $\sF$ on $\PP$. Executing
{\small \begin{verbatim}
B = beilinsonMonad M
\end{verbatim}}
produces a complex $B$ of graded $S$-modules such that the corresponding complex $\widetilde{B}$ of sheaves on $\PP$ is the Beilinson monad $\bU(\sF)$.  For example, if we take $M$ to be a twist of the syzygy module of the maximal ideal in the bihomogeneous
coordinate ring $S$ of $\PP=\PP^1\times \PP^2$, we can execute:
{\small \begin{verbatim}
M =  S^{{1,1}} ** ker vars S
cohomologyMatrix (M,{-3,-3}, {3,3})
\end{verbatim}}
This outputs:
{\small \begin{verbatim}
      | 75h 30h 15  60  105 150  195  |
      | 48h 20h 8   36  64  92   120  |
      | 27h 12h 3   18  33  48   63   |
      | 12h 6h  0   6   12  18   24   |
      | 3h  2h  h   0   1   2    3    |
      | 0   0   0   0   0   0    0    |
      | 3h3 0   3h2 6h2 9h2 12h2 15h2 |
\end{verbatim}}
     

Since $\bU E(a)$ is nonzero only when $a$ is in the range $-n\leq a \leq 0$, the output of the functor $\bU$ only depends on the piece of $\bT(\sF)$ with generators lying in the Beilinson window.  The command \verb beilinsonWindow \ computes the corresponding subquotient complex of the Tate resolution:
{\small \begin{verbatim}
T=tateResolution(M,low,high);
W = beilinsonWindow T
        6      1
       E  <-- E
betti W
             0 1
      total: 6 1
          0: 6 .
          1: . 1
 \end{verbatim}}

The Beilinson monad itself is obtained by applying the $\bU$ functor to any piece of $\bT(\sF)$ which contains the Beilinson window.  This can be computed directly from the module $M$ via:
\begin{verbatim}
B = beilinsonMonad M
\end{verbatim}
which, in this case, gives a two-term complex:
{\small
\begin{verbatim}     
 6
S  <-- cokernel {1, 1} | x_(1,2)  |
                {1, 1} | -x_(1,1) |
                {1, 1} | x_(1,0)  |
\end{verbatim}}

\noindent
whose differential is given by the matrix
{\small
\begin{verbatim}
   | x_(0,1)x_(1,1)  x_(0,1)x_(1,2)  0               | 
   | -x_(0,0)x_(1,1) -x_(0,0)x_(1,2) 0               | 
   | -x_(0,1)x_(1,0) 0               x_(0,1)x_(1,2)  |
   | x_(0,0)x_(1,0)  0               -x_(0,0)x_(1,2) |
   | 0               -x_(0,1)x_(1,0) -x_(0,1)x_(1,1) |
   | 0               x_(0,0)x_(1,0)  x_(0,0)x_(1,1)  |
\end{verbatim}
}

Macaulay2 computes this by first computing sufficiently many terms of the Tate resolution
of $\sF$, extracting  the terms
that belong to the "Beilinson window", and  applying the Beilinson functor.
We can take the cohomology matrix of the Beilinson window to understand
the terms that are there:
{\small
\begin{verbatim}
cohomologyMatrix(W,low, high)
     | 0 0 0 0 0 0 0 |
     | 0 0 0 0 0 0 0 |
     | 0 0 0 0 0 0 0 |
     | 0 0 0 6 0 0 0 |
     | 0 0 h 0 0 0 0 |
     | 0 0 0 0 0 0 0 |
     | 0 0 0 0 0 0 0 |
tallyDegrees W
      (Tally{{0, 0} => 6}, Tally{{1, 1} => 1})
 \end{verbatim}}

The 0th-cohomology of the Beilinson monad is a module representing the sheaf $\sF$,
while the other cohomology is trivial as a sheaf. However, one should be careful, 
as this is not necessarily true as modules!
 In our example, $M$ has a generator in degree $\{-1,1\}$, but ${\rm H}^0 B$ does not.
To see that they are the same sheaves, we need to truncate appropriately;
{\small
\begin{verbatim}
isIsomorphic(HH^0 B ,M)
   false
isIsomorphic (truncate({0,0},HH^0 B),truncate({0,0},M))
   true
\end{verbatim}}

Since the Beilinson window of a complex determines the complex, it determines the Tate resolution, 
and we can compute this directly using the command {\tt tateExtension}. This allows us to compute the hypercohomology of a complex directly from the Beilinson window, a computation of interest even in case of a single projective space. For an example on $\P^1\times \P^1$, consider the Beilinson window consisting of the map defined by the variables of the exterior algebra  associated to the Cox ring.
{\small \begin{verbatim}
 W=beilinsonWindow T
       1      4
      E  <-- E              
      -1     0
 cohomologyMatrix(W,low,high)
      | 0 0 0  0  0 0 0 |
      | 0 0 0  0  0 0 0 |
      | 0 0 0  0  0 0 0 |
      | 0 0 2h h  0 0 0 |
      | 0 0 0  2h 0 0 0 |
      | 0 0 0  0  0 0 0 |
      | 0 0 0  0  0 0 0 |
T'=tateExtension W; 
cohomologyMatrix(T',low,high) 
      | 28h  18h  8h  2  12  22  32  |
      | 20h  13h  6h  1  8   15  22  |
      | 12h  8h   4h  0  4   8   12  |
      | 4h   3h   2h  h  0   1   2   |
      | 4h2  2h2  0   2h 4h  6h  8h  |
      | 12h2 7h2  2h2 3h 8h  13h 18h |
      | 20h2 12h2 4h2 4h 12h 20h 28h |
\end{verbatim}}


\section{$R\pi_*$}\label{sec:push forward}

In this section we explain how to compute the pushforward complex of a sheaf along a morphism
to projective space. The main ingredient is the pushforward to a factor in a product of projective
spaces, and we explain this first.

Let $I \subset \{0,\ldots,t-1 \}$ be a proper subset and let
$$ \pi \colon\PP \to  \PP^I=\prod_{i \in  I} \PP^{n_{i+1}}$$
be the projection to the corresponding factors. (Note that Macaulay2 prefers integers sequences starting with $0$ in many commands, which is the reason for the re-indexing.) Given a coherent sheaf $\sF$ on $\PP$, represented by an $S$-module $M$,
the function
{\small \begin{verbatim}
directImageComplex(M,I)
\end{verbatim}}
\noindent computes a complex of $S_I = \Sym (\oplus_{i \in I} W_{i+1})$-modules, whose sheafication
is the (minimal) Beilinson complex representing the direct image complex $R\pi_* \sF$ in $D^b(\PP^I)$. 

Let $J=\{0,\ldots,t-1\} \setminus I$.
The routine uses 
the "strand" complex
$$
strand(T,c,J)
$$
defined from the Tate resolution $T=\bT(\sF)$ as the sum of the terms
corresponding to the vector spaces $H^p(\sF(a))$ with $a_{j+1}=c_{j+1}$ for $j \in J$.
This sum is a complex over $E_I= \Lambda( \oplus_{i\in I} V_{i+1})$.
 The key fact is that, for $c=(0,\dots,0) \in \ZZ^t$, 
 $
strand(T,c,J)
$
 is the Tate resolution of $R\pi_* \sF \in D^b(\PP^I)$.
Thus applying the $\bU$ functor on $\PP^I$
gives the Beilinson monad for $R\pi_* \sF \in D^b(\PP^I)$.

Here is an example:
{\small \begin{verbatim}
m=matrix{{x_(1,0),x_(1,1)},{x_(1,1),x_(1,2)}}|
matrix{{x_(0,0),x_(0,1),0},{0,x_(0,0),x_(0,1)}}
     | x_(1,0) x_(1,1) x_(0,0) x_(0,1) 0       |
     | x_(1,1) x_(1,2) 0       x_(0,0) x_(0,1) |
              2       5
      Matrix S  <--- S
radical annihilator coker m
                          2
      ideal (x   , x   , x    - x   x   )
              0,1   0,0   1,1    1,0 1,2
M=ker m;
\end{verbatim}}
 
 \noindent
$M$ represents a rank 3 vector bundle $\sF$ on $\PP^1\times \PP^2$, since  $\coker \rm m$ sheafifies to the zero sheaf. We compute the \emph{jumping locus},  that is, the locus of points $p \in \PP^2$ where $\sF\otimes \sO_{\PP^1\times p} \not\cong \sO_{\PP^1}^3(-1)$.
{\small \begin{verbatim}
T=tateResolution(M,low,high); 
cohomologyMatrix(T,low,high)
      | 74h  52h  30h 8h  14   36   58   |
      | 42h  30h  18h 6h  6    18   30   |
      | 19h  14h  9h  4h  1    6    11   |
      | 5h   4h   3h  2h  h    0    1    |
      | 0    0    0   0   0    0    0    |
      | 4h3  2h3  0   2h2 4h2  6h2  8h2  |
      | 17h3 10h3 3h3 4h2 11h2 18h2 25h2 |
cohomologyMatrix(strand(T,{0,0},{0}),low,high)
      | 0 0 0 8h  0 0 0 |
      | 0 0 0 6h  0 0 0 |
      | 0 0 0 4h  0 0 0 |
      | 0 0 0 2h  0 0 0 |
      | 0 0 0 0   0 0 0 |
      | 0 0 0 2h2 0 0 0 |
      | 0 0 0 4h2 0 0 0 | 
RpiM=directImageComplex(M,{1});
betti RpiM
             -1 0
      total:  2 2
          1:  2 2
\end{verbatim}
\noindent The one differential of this complex is
\begin{verbatim}
RpiM.dd_0
      | -x_(0,0) x_(0,1)  |
      | x_(0,1)  -x_(0,2) |
\end{verbatim}
\noindent and thus the jumping locus is the conic defined by the determinant of this matrix. We can also compute:
\begin{verbatim}
HH^1 RpiM
      cokernel | -x_(0,0) x_(0,1)  |
               | x_(0,1)  -x_(0,2) |
HH^0 RpiM == 0 
     true 
 \end{verbatim}}

We now return to the general problem of the pushforward $R\pi_* \sF$ of a sheaf $\sF$ on a projective scheme $X$ under a morphism 
$$
\pi \colon X \to \PP^m
$$
The result will be a complex of graded modules that represents
$R\pi_* \sF \in D^b(\PP^m)$.

To specify the morphism $\pi$, we suppose that $X$ is given by its homogeneous ideal $J \subset R = K[x_0,\ldots,x_n]$. Locally near any point of $X$ the morphism can be given by $m+1$ homogeneous
forms of the same degree, but a different representation is necessary points where all these forms are 0. To represent $\pi$
at every point of $X$ at once, we thus allow $k$ such representations, which we package as a
 $k \times (m+1)$ matrix $\phi=(\phi_{ij})$ of homogeneous forms in $R$, such that any two forms
 in the same row have the same degree. To ensure that the different rows define the same
 morphism where both are nonzero, we insist that
 \begin{itemize}
\item the $2\times 2$ minors of $\phi$ are contained in $J$,
\end{itemize}
and to ensure that at least one of the definitions is valid at each point we insist that
\begin{itemize}
\item the entries of $\phi$ have no common zero on $X=V(J)$.
\end{itemize}

Representing $\sF$ by  a homogeneous $R$-module $N$
whose annihilator contains $J$, the function
{\small \begin{verbatim}
directImageComplex(J,N,phi)
\end{verbatim} }
returns a complex as a complex of graded $T$-modules representing $R\pi_* \sF \in D^b(\PP^m)$, where the $T$ denotes  the homogeneous coordinate ring of $\PP^m$.

As a concrete example we take the cubic scroll 
$$\PP(\sO_{\PP^1}(2) \oplus \sO_{\PP^1}(1))\cong X\subset \PP^4
$$ 
defined by the ideal of minors of the $2\times 3$ matrix
$$
m=\begin{pmatrix}
x_0& x_1 & x_3 \cr
x_1 & x_2 & x_4 \cr
\end{pmatrix}   
$$
and the morphism $\pi :X \to \PP^1$ defined at each point by the ratio of (at least) one of 
the columns of $m$, so that the map $\pi$ is represented, in the sense above,
by the matrix $\phi = {\rm transpose}\ m$. 

For this example we take $\sF = \sO_X(1)\otimes \pi^*\sO_{\PP^1}(2)$, which is the sheaf associated to the
graded module
$N$ that is the first twist of the second symmetric power of the cokernel 
of $m$.
{\small\begin{verbatim}
kk=ZZ/101;
R=kk[x_0..x_4];
m=matrix{{x_0,x_1,x_3},{x_1,x_2,x_4}}
       | x_0 x_1 x_3 |
       | x_1 x_2 x_4 |
J=minors(2,m);
N=symmetricPower(2,coker m)**R^{1};
phi=transpose m;
RpiN=directImageComplex(J,N,phi);
T=ring RpiN;
RpiN
        9      7
       T  <-- T               
       0      1
betti RpiN
              0 1
       total: 9 7
           0: 9 7
dim HH^0 RpiN, degree HH^0 RpiN
       (2, 2)
\end{verbatim}
\noindent Thus $\pi_*N = R^0\pi_*N$ is a vector bundle on $\P^1$ of rank 2.
To decide which bundle, we compute
\begin{verbatim}
 s=transpose syz transpose presentation HH^0 RpiN;
               2       9
       Matrix T  <--- T
degrees target s
       {{-3}, {-4}} 
\end{verbatim} }
\noindent and we see that $R^1\pi_* \sF \cong \sO_{\PP^1}(3) \oplus \sO_{\PP^1}(4)$.
Of course this result could have been deduced from the abstract description of $X$ and $\sF$
above, as well.

\section{Corner complexes.}\label{sec:cornercomplex}

We now explain how we go about computing a given finite part of the Tate resolution
of a sheaf $\sF$ on $\PP$ from a finitely generated, multi-graded module $M$
representing $\sF$.

We first determine a muti-degree $c \in \ZZ^t$ such that $bgg(M_{ \ge c})$ is acyclic.
The function {\tt coarseMultigradedRegularity(M)} returns such a $c$.

Set $N$ equal to the kernel of the multiplication map
$$ 
M_c \otimes E(c) \to \bigoplus_{d=c+e_k}M_{d} \otimes E(d) 
$$
where $e_k \in \ZZ^t$ runs through the set of unit basis vectors,
so that, by Theorem~\ref{Reciprocity}, the complex $bgg(M_{\ge c})$ is an injective resolution of $N$.
In case $t=2$ and $c=(i,j)$ this is the total complex of the double complex displayed in the diagram (\ref{eqn:uppercorner})
 
In \cite{EES} we prove that
the projective resolution of $N(1,\ldots,1)$ is the part of the Tate resolution whose terms correspond to the cohomology groups
$H^p(\PP, \sF(a))$ for  $a \in \ZZ^t$ with $a_k\le c_k -1$ for all $k$. 

Combining this projective resolution  
 with the injective resolution 
 $$
 bgg(N)(1,\ldots,1)
 $$
   we get a doubly infinite exact complex of finitely generated graded free $E$-modules.
This is what we call a {\bf corner complex} with corner at $c$, denoted
${\bf \cornerT c} (\sF))$. If $t=1$, then the corner complex
is independent of $c$, and is the Tate resolution. 

However if $t>1$ neither of these statements is true; the modules in the corner complex, unlike those in the Tate resolution, are finitely generated, and the corner complex depends  on $c$ and computes only
some of the cohomology groups of $\sF$. The Tate resolution  $\bT(\sF)$ is actually 
 the limit of the projective parts of the corner complexes as  $c \to \infty$.
 
 Since our goal is to compute the finite part of a Tate resolution containing all the free summands corresponding to the $H^p(\PP, \sF(a))$ for  indices $a$ in some bounded region of $\ZZ^t$, 
it suffices to compute the projective part of the corner complex ${\bf \cornerT c} (\sF))$ for sufficiently
positive $c$.

%$\bT(\sF)$  has many intrinsically defined free subquotient complexes, called {\bf region complexes}, many of which are exact. The most interesting complexes are obtained from $t$ exact half space complexes which combines terms corresponding to $a\in \ZZ^t$ in a last quadrant with terms in a first quadrant, at an arbitrary $c \in \ZZ^t$ as an origin. These corner complexes $\cornerT c (\sF)$ coincide for $c$ in the multi-regularity range with the complexes described above. For general $c$ however neither the first quadrant part nor the last quadrant part are double complexes. Moreover the contribution to a term ${\cornerT c}^d (\sF)$ of both quadrants can overlap.
%However, what ist true is that for any $c\in \ZZ^t$ the zeroes syzygy module $N = \ker({\cornerT c}^0 (\sF) \to {\cornerT c}^1 (\sF))$
%is an finitely generated $E$-module such that $bgg(N)$ is linear complex of $S$-modules, which sheafifies to a monad for $\sF$.
We illustrate this in an example . We work on 
$\PP^1\times \PP^1$, with homogeneous coordinate ring $S$, and take
$\sF$ to be the rank $3$ vector bundle represented by the graded module
$M$ that is the kernel of the map given by the variables of $S$.
We begin by defining the multi-graded polynomial ring $S$ and corresponding exterior algebra $E$ 
and the module $M$:
{\small 
\begin{verbatim}
n={1,1}, 
(S,E)=productOfProjectiveSpaces n;
 M = ker vars S;
\end{verbatim}
%We will construct $M$ from a module $P$ over the exterior algebra:
%\begin{verbatim}
%P=(image transpose gens trim (ideal vars E)^2)**E^{n}
%     image {-1, -3} | -e_(1,0)e_(1,1) |
%           {-2, -2} | -e_(0,1)e_(1,1) |
%           {-2, -2} | -e_(0,0)e_(1,1) |
%           {-2, -2} | -e_(0,1)e_(1,0) |
%           {-2, -2} | -e_(0,0)e_(1,0) |
%           {-3, -1} | -e_(0,0)e_(0,1) |
%LP=bgg P 
%      6      4      1
%     S  <-- S  <-- S                    
%     0      1      2
%M = (HH^0 LP)**S^{-n}
%     cokernel {2, 0} | x_(1,1)  -x_(1,0) 0       0        |
%              {1, 1} | -x_(0,0) 0        x_(1,0) 0        |
%              {1, 1} | 0        -x_(0,0) x_(1,1) 0        |
%              {1, 1} | -x_(0,1) 0        0       x_(1,0)  |
%              {1, 1} | 0        -x_(0,1) 0       x_(1,1)  |
%              {0, 2} | 0        0        x_(0,1) -x_(0,0) |
%\end{verbatim}
%We can now compute a piece of the Tate resolution of $M$ sufficient to give the cohomology
%in a given range bounded by indices "low" and "high", and we can use the function
%cohomologyMatrix on this Tate resolution to see this cohomology:
%\begin{verbatim}
%low = {-3,-3}, high={3,3};
%T = tateResolution(M,low,high); 
%cohomologyMatrix(T,low,high)
%      | 28h  18h  8h  2  12  22  32  |
%      | 20h  13h  6h  1  8   15  22  |
%      | 12h  8h   4h  0  4   8   12  |
%      | 4h   3h   2h  h  0   1   2   |
%      | 4h2  2h2  0   2h 4h  6h  8h  |
%      | 12h2 7h2  2h2 3h 8h  13h 18h |
%      | 20h2 12h2 4h2 4h 12h 20h 28h |
%\end{verbatim}}
%
%\noindent
%We can recover $M$ from the Beilinson monad derived from T:
%{\small \begin{verbatim}
%B=beilinson T
%       1      4
%      S  <-- S              
%      -1     0
%M'=prune HH^0 B
% cokernel{1, 1}|-x_(1,1) 0        0        -x_(0,1)|
%         {0, 2}|x_(0,0)  x_(0,1)  0        0       |
%         {1, 1}|-x_(1,0) 0        -x_(0,1) 0       |
%         {1, 1}|0        -x_(1,0) x_(0,0)  0       |
%         {1, 1}|0        -x_(1,1) 0        x_(0,0) |
%         {2, 0}|0        0        -x_(1,1) x_(1,0) |
%prune HH^1 B
%      cokernel | x_(1,1) x_(1,0) x_(0,1) x_(0,0) |
%isIsomorphic(M,M')
%      true
%\end{verbatim}}

\noindent
We now compute the corner complex of $M$ at $c=\{0,0\}$.
{\small \begin{verbatim}
c = {0,0};
C = cornerComplex(M,c,low,high);
betti C
total: 32 44 39 20  6  1 4 15 36 70 120 189
    0: 32 44 39 20  6  . .  .  .  .   .   .
    1:  .  .  .  .  .  1 .  .  .  .   .   .
    2:  .  .  .  .  .  . .  .  .  .   .   .
    3:  .  .  .  .  .  . 4 15 36 70 120 189
\end{verbatim}
%\frank{unfortunately the numbers in the injective part are wrong. 39 should be 45 and so on. The reason is that we obtained C by the corner construction from a complex which already was a corner complex. So this is a bug in our package!}
%Applying the function cohomologyMatrix to $C$ and to $M$ 
%we see that the corner complex has captured just the
%cohomology in the regions $a\leq c$ and $a\geq c+n$:
%\begin{verbatim}
% cohomologyMatrix(C,low,high)
%      | 0    0    0   2 12 22 32 |
%      | 0    0    0   1 8  15 22 |
%      | 0    0    0   0 4  8  12 |
%      | 0    0    0   h 0  1  2  |
%      | 4h3  2h3  0   0 0  0  0  |
%      | 12h3 7h3  2h3 0 0  0  0  |
%      | 20h3 12h3 4h3 0 0  0  0  |
%\end{verbatim}}
%betti C.dd_0
%             0 1
%      total: 1 4
%          0: 1 .
%          1: . .
%          2: . 4
%P=ker C.dd_0**E^{v};
%LP=bgg P;
%             -3 -2 -1  0
%      total:  4 16 24 15
%          0:  4 16 24 15
%coLP=apply(toList(min LP..max LP),i->prune HH^(-i) LP);
%apply(coLP,h->dim h)
%      {0, -1, 0, 4}
%M1=HH^0 LP;
%betti M1,betti M
%              0 1         0 1
%      (total: 6 4, total: 6 4)
%           2: 6 4      2: 6 4
%isIsomorphic(M,M1)
%      true

\noindent
For further information, for examples for the definition of the corner complex $\cornerT c (\sF)$ for arbitrary $c \in \ZZ^t$, we refer \cite[Section 3]{EES} and to  the documentation for the function  {\tt composedFunctions}
 in our package.
%
%
%strands etc


\begin{bibdiv}
\begin{biblist}

\bib{AO}{article}{
    AUTHOR = {Ancona, Vincenzo} ,
    author={Ottaviani, Giorgio},
     TITLE = {An introduction to the derived categories and the theorem of
              {B}eilinson},
   JOURNAL = {Atti Accad. Peloritana Pericolanti Cl. Sci. Fis. Mat. Natur.},
  FJOURNAL = {Accademia Peloritana dei Pericolanti. Classe di Scienze,
              Fisiche, Matematiche e Naturali. Atti},
    VOLUME = {67},
      YEAR = {1989},
     PAGES = {99--110 (1991)}
     }

\bib{beilinson}{article}{
   author={Be{\u\i}linson, A. A.},
   title={Coherent sheaves on ${\bf P}^{n}$ and problems in linear
   algebra},
   language={Russian},
   journal={Funktsional. Anal. i Prilozhen.},
   volume={12},
   date={1978},
   number={3},
   pages={68--69},
   issn={0374-1990},
   review={\MR{509388 (80c:14010b)}},
}


\bib{BGG}{article}{
   author={Bern{\v{s}}te{\u\i}n, I. N.},
   author={Gelfand, I. M.},
   author={Gelfand, S. I.},
%   author={Gel{\cprime}fand, I. M.},
%   author={Gel{\cprime}fand, S. I.},
   title={Algebraic vector bundles on ${\bf P}^{n}$ and problems of linear
   algebra},
   language={Russian},
   journal={Funktsional. Anal. i Prilozhen.},
   volume={12},
   date={1978},
   number={3},
   pages={66--67},
   issn={0374-1990},
   review={\MR{509387 (80c:14010a)}},
}

	
	
\bib{EES}{article}{
  author={Eisenbud, David},
  author={Erman, Daniel},
  author={Schreyer, Frank-Olaf},
  title={\href{http://dx.doi.org/10.1007/s40306-015-0126-z}%
    {Tate resolutions for products of projective spaces}},
  journal={Acta Math. Vietnam.},
  volume={40},
  date={2015},
  number={1},
  pages={5--36},
  % issn={0251-4184},
  % review={\MR{3331930}},
  % doi={10.1007/s40306-015-0126-z},
}

\bib{EFS}{article}{
   author={Eisenbud, David},
   author={Fl\o ystad, Gunnar},
   author={Schreyer, Frank-Olaf},
   title={Sheaf cohomology and free resolutions over exterior algebras},
   journal={Trans. Amer. Math. Soc.},
   volume={355},
   date={2003},
   number={11},
   pages={4397--4426 (electronic)},
%   issn={0002-9947},
%   review={\MR{1990756 (2004f:14031)}},
%   doi={10.1090/S0002-9947-03-03291-4},
}
\bib{Huy}{book}{
    AUTHOR = {Huybrechts, D.},
     TITLE = {Fourier-{M}ukai transforms in algebraic geometry},
    SERIES = {Oxford Mathematical Monographs},
 PUBLISHER = {The Clarendon Press, Oxford University Press, Oxford},
      YEAR = {2006},
     PAGES = {viii+307}
}

%\bib{maclagan-smith}{article}{
%   author={Maclagan, Diane},
%   author={Smith, Gregory G.},
%   title={Multigraded Castelnuovo-Mumford regularity},
%   journal={J. Reine Angew. Math.},
%   volume={571},
%   date={2004},
%   pages={179--212},
%   issn={0075-4102},
%   review={\MR{2070149 (2005g:13027)}},
%   doi={10.1515/crll.2004.040},
%}

\bib{M2}{misc}{
    label={M2},
    author={Grayson, Daniel~R.},
    author={Stillman, Michael~E.},
    title = {Macaulay2, a software system for research
	    in algebraic geometry},
    note = {Available at \url{http://www.math.uiuc.edu/Macaulay2/}},
}

\bib{M2BGG}{misc}{
    label={M2-BGG},
    author = {Abo, Hirotachi},
    author = {Decker, Wolfram},
    author = {Eisenbud, David},
    author={Schreyer, Frank-Olaf},
    author = {Smith, Gregory~G.},
author={Stillman, Michael~E.},
    title = {BGG, package for Macaulay2},
    note = {Available at \url{http://www.math.uiuc.edu/Macaulay2/}},
}

\bib{TateOnProducts}{misc}{
    label={M2-Tate},
    author={Eisenbud, David},
    author={Erman, Daniel},
    author={Schreyer, Frank-Olaf},
    title = {TateOnProducts, package for Macaulay2},
    note = {Available at \url{http://www.math.uiuc.edu/Macaulay2/}},
}

\end{biblist}
\end{bibdiv}

%\bibliographystyle{ABC99}
%\begin{thebibliography}{ABC99}

%\bibitem{Bass1963} Bass, Hyman
%On the ubiquity of Gorenstein rings.
%Math. Z. 82 1963 8\UTF{2013}28.



%\bibitem[A05]{A} M.~Aprodu: Remarks on syzygies of d-gonal curves Green's conjecture for curves,  Math. Res. Lett. 12 (2005), no. 2-3, 387--400.
%
%\bibitem[AF11]{AF} M.~Aprodu and G.~Farkas: Green's conjecture for curves on arbitrary {$K3$} surfaces, Compos. Math. 147 (2011), 839--851.
%
% \bibitem[AFPRW]{AFPRW} M.~Aprodu, G.~Farkas, S.~Papadima, C.~Raicu and J.~Weyman: In preparation.
%
%\bibitem[AB58]{AB} M.~Auslander and D.~Buchsbaum: Codimension and Multiplicity. Annals of Mathematics 68 (1958) 625--657.
%
%
%\bibitem[BE95]{BE} D.~Bayer and D.~Eisenbud: Ribbons and their canonical embeddings. Trans. Amer. Math. Soc. 347 (1995) 719--756. 
%
%
%\bibitem[BS15]{BS15}C.~Berkesch and F.-O.~Schreyer:
%Syzygies, finite length modules, and random curves, in:
%Commutative algebra and noncommutative algebraic geometry, {V}ol. {I},
%Math. Sci. Res. Inst. Publ.,
%67 (2015),
%25--52.
%
%\bibitem[B17]{Bopp} C.~Bopp: Canonical curves, Scrolls and K3 surfaces. \href{https://publikationen.sulb.uni-saarland.de/bitstream/20.500.11880/26917/1/phd_bopp.pdf}{Dissertation, Saarbr\"ucken Fall 2017}.
%
%\bibitem[BH15]{BH15} C.~Bopp and M.~Hoff: Resolutions of general canonical curves on rational normal scrolls. Archiv der Mathematik (Basel) 105 (2015) 239--249.
%
%\bibitem[BH17]{BH17} C.~Bopp and M.~Hoff: Moduli of lattice polarized K3 surfaces via relative canonical resolutions. Preprint \href{https://arxiv.org/abs/1704.02753}{arXiv:1704.02753}.
%
%
%
%
%\bibitem[BS18]{BS18} C.~Bopp and F.-O.~Schreyer:  A version of Green's conjecture over fields of finite characteristic. Preprint \href{https://arxiv.org/abs/1803.10481}{arXiv:1803.10481}.
%
%\bibitem[BH93]{BH93} W.~Bruns and J.~Herzog, J\"urgen:
%Cohen-{M}acaulay rings
%Cambridge Studies in Advanced Mathematics 39, Cambridge University Press. xi, 403 p. (1993). 
%
%\bibitem[D15]{D} A.~Deopurkar: The canonical syzygy conjecture for ribbons. \href{https://arxiv.org/abs/1510.07755}{arXiv:1510.07755}
%
%\bibitem[DFS16]{DFS} A.~Deopurkar, M.~ Fedorchuk and D.~Swinarski: Toward GIT stability of syzygies of canonical curves.
% Algebr. Geom.  3  (2016),  no. 1, 1--22.
%
%\bibitem[E97]{E} D.~Eisenbud: Commutative Algebra with a View toward Algebraic Geometry. GTM 150, Springer-Verlag NY, 1997.
%
%\bibitem[E05]{E05} D.~Eisenbud: The Geometry of Syzygies. GTM 229, Springer-Verlag NY, 2005.
%
%\bibitem[EH87]{EH} D.~Eisenbud and J.~Harris: Varieties of Minimal Degree (a centennial account). Algebraic geometry, 
%Proc. Sympos. Pure Math., 46, Part 1, pp. 3-13. Amer. Math. Soc., Providence, RI, 1987. 
%
%
%
%\bibitem[EiSa]{EiSa} D.~Eisenbud and A.~Sammartano: Correspondence Scrolls. In preparation.
%
%\bibitem[ES18]{ES18} D.~Eisenbud and F.-O.~Schreyer: K3Carpets , a Macaulay2 package to investigate K3 carpets.
%Available at\\ \href{https://www.math.uni-sb.de/ag/schreyer/index.php/computeralgebra}{https://www.math.uni-sb.de/ag/schreyer/index.php/computeralgebra}.
%
%\bibitem[EMSS16]{EMSS} B.~Erocal, O.~Motsak, F.-O.~Schreyer and A.~Steenpass: 
%Refined Algorithms to Compute Syzygies. J. Symb. Comput. 74 (2016), 308--327.
%
%\bibitem[F69]{F69} W.~Fulton: Hurwitz schemes and irreducibility of moduli of algebraic curves. Ann. Math. (2)
%90 (1969), 542--575.
%
%\bibitem[GP97]{GP}  F.J.~Gallego and B.~Purnaprajna, Degenerations of K3 surfaces in projective space.
%Trans. Amer. Math. Soc. 349 (1997) 2477--2492.
%
%\bibitem[M2]{M2} D.R.~ Grayson and M.E.~ Stillman,
%          Macaulay2, a software system for research in algebraic geometry.
%          Available at \href{https://faculty.math.illinois.edu/Macaulay2/}{https://faculty.math.illinois.edu/Macaulay2/}
%      
%\bibitem[M95]{Muk}   S.~Mukai, Curves and symmetric spaces I. Amer. J. Math 117 (1995), 1627--1644.
%
%\bibitem[S86]{S86} F.-O.~Schreyer: Syzygies of canonical curves and special linear series. Math. Ann. 275 (1986), 105--137.
%
%\bibitem[S88]{S88} F.-O.~Schreyer: Green's conjecture for the general p-gonal curve of large genus. In: Algebraic curves and projective geometry, Proceedings Trento 1988, Springer Lecture Notes 1389, 254--260.
%
%\bibitem[S91]{S91} F.-O.~Schreyer: A standard basis approach to syzygies of canonical curves. J. reine angew. Math. 421 (1991), 83--123.
%
%
%\bibitem[V05]{V05} C.~Voisin: 
%Green's canonical syzygy conjecture for generic curves of odd genus. Compos. Math. 141 (2005) 1163--1190. 

%\end{thebibliography}

%\bigskip
%
%%\author[David Eisenbud]{David Eisenbud}
%%\address{ Department of mathematics, University of California at Berkeley, Berkeley, CA 94720, USA, and 
%%The Mathematical Sciences Research Institute}
%%\email{de@msri.org}
%%
%%\author[Frank-Olaf Schreyer]{Frank-Olaf Schreyer}
%%\address{Fachbereich Mathematik, Universit\"at des Saarlandes, Campus E2 4, D-66123 Saar\-br\"ucken, Germany}
%%\email{schreyer@math.uni-sb.de}
%%
%%\vbox{\noindent Author Addresses:\par
%%\smallskip
%%\noindent{David Eisenbud}\par
%%\noindent{Mathematical Sciences Research Institute,
%%Berkeley, CA 94720, USA}\par
%%\noindent{de@msri.org}\par
%%}

\end{document}



